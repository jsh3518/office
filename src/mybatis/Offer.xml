<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.office.mapper.OfferMapper">
	<sql id="offerColumns">offerid,offername,parent,level,sort,istrial</sql>

	<resultMap type="Offer" id="offerResultMap">
		<id column="offerid" property="offerId"/>
		<result column="offername" property="offerName"/>
		<result column="parent" property="parent"/>
		<result column="level" property="level"/>
		<result column="sort" property="sort"/>
		<result column="istrial" property="isTrial"/>
	</resultMap>
	
	<select id="listOffer" resultMap="offerResultMap">
		select * from offer where 1=1
		<if test="offerId!=null and offerId!=0">
			and offerid = #{offerId}
		</if>
		<if test="offerName!=null and offerName!=''">
			and offername like "%"#{offerName}"%"
		</if>
		<if test="parent!=null and parent!=''">
			and parent = #{parent}
		</if>
		<if test="level!=null and level!=''">
			and level = #{level}
		</if>
		<if test="istrial!=null and istrial!=''">
			and istrial = #{isTrial}
		</if>
		order by sort
	</select>
	
	<select id="listOfferByLevel" resultMap="offerResultMap">
		select o.offerid,o.offername,o.parent,o.level,o.sort,o.istrial
		from offer o 
		where o.level = #{level} order by sort
	</select>
	
	<select id="listOfferByParent" resultMap="offerResultMap">
		select o.offerid,o.offername,o.parent,o.level,o.sort,o.istrial
		from offer o 
		where o.parent = #{parent}
	</select>

</mapper>